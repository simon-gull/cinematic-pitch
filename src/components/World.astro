---
interface Props {
  text: string
  visual?: string
}

const { text, visual = '' } = Astro.props
---

<section class="world-section relative" style="background: #0A0A0A;">
  <div class="h-[15vh]"></div>

  {visual && (
    <div class="world-image relative overflow-hidden opacity-0" data-world-image style="height: 70vh;">
      <img src={visual} alt="" class="w-full h-full object-cover" />
      <div class="absolute inset-0" style="background: linear-gradient(to top, #0A0A0A 0%, transparent 40%);"></div>
    </div>
  )}

  <div class="max-w-3xl mx-auto px-6 md:px-16 py-16 md:py-24 {visual ? '-mt-32 relative z-10' : ''}">
    <p class="world-text font-body text-lg md:text-xl font-light leading-relaxed text-pitch-white/80 opacity-0" data-world-text>
      {text}
    </p>
  </div>

  <div class="h-[10vh]"></div>
</section>

<script>
  import { gsap } from 'gsap'
  import { ScrollTrigger } from 'gsap/ScrollTrigger'
  gsap.registerPlugin(ScrollTrigger)

  document.querySelectorAll('[data-world-image]').forEach(el => {
    gsap.fromTo(el,
      { opacity: 0 },
      {
        opacity: 1,
        duration: 1.5,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: el,
          start: 'top 80%',
          toggleActions: 'play none none none',
        }
      }
    )
  })

  document.querySelectorAll('[data-world-text]').forEach(el => {
    gsap.fromTo(el,
      { opacity: 0, y: 30 },
      {
        opacity: 1, y: 0,
        duration: 1,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: el,
          start: 'top 75%',
          toggleActions: 'play none none none',
        }
      }
    )
  })
</script>
